<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <title>Détails du Roman</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <style>
        body {
            background-color: #f0f2f5;
            font-family: 'Segoe UI', sans-serif;
        }
        .card {
            background: #fff;
            border-radius: 12px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
            max-width: 850px;
            margin: 60px auto;
            padding: 30px;
        }
        .novel-title {
            color: #1f2a44;
            font-weight: bold;
        }
        .novel-img {
            width: 100%;
            max-height: 500px;
            object-fit: cover;
            border-radius: 8px;
        }
        .form-label {
            font-weight: 600;
        }
        .text-muted {
            font-size: 0.9rem;
        }
        .btn-custom {
            background-color: #6c757d;
            border: none;
        }
        .btn-custom:hover {
            background-color: #5a6268;
        }
    </style>
</head>
<body>
<div class="container">
    <div class="card">
        <!-- Titre du roman -->
        <h2 class="novel-title text-center mb-4" th:text="${novel.name}">Titre du Roman</h2>

        <!-- Image du roman -->
        <div class="text-center mb-4">
            <img th:src="@{/novels/image/{id}(id=${novel.id})}" alt="Image du roman" class="novel-img" />
        </div>

        <!-- Détails du roman -->
        <div class="mb-3">
            <label class="form-label">Résumé :</label>
            <p th:text="${novel.summary}">Résumé...</p>
        </div>

        <div class="mb-3">
            <label class="form-label">Catégorie :</label>
            <p th:text="${novel.category}">Catégorie...</p>
        </div>

        <div class="mb-3">
            <label class="form-label">Tags :</label>
            <p th:text="${novel.tags}">Tags...</p>
        </div>

        <!-- Note Moyenne -->
        <div class="mb-4">
            <h5>Note Moyenne :
                <span th:text="${novel.averageRatingRounded}">5.0</span> ★
            </h5>
        </div>

        <!-- Formulaire de notation -->
        <div class="mb-4">
            <form th:action="@{/novels/{id}/rate(id=${novel.id})}" method="post">
                <label for="score" class="form-label">Votre note (1 à 5) :</label>
                <input type="number" name="score" min="1" max="5" class="form-control mb-2" required />
                <button type="submit" class="btn btn-primary">Soumettre</button>
            </form>
        </div>

        <!-- Commentaires -->
        <h5>Commentaires :</h5>
        <ul class="list-unstyled mb-4">
            <li th:each="comment : ${novel.comments}" class="mb-2 border-bottom pb-2">
                <strong th:text="${comment.userId}">Utilisateur</strong> :
                <span th:text="${comment.content}"></span>
                <div class="text-muted">
                    <small th:text="${#temporals.format(comment.createdAt, 'dd-MM-yyyy HH:mm')}">Date</small>
                </div>
            </li>
        </ul>

        <!-- Formulaire de commentaire -->
        <form th:action="@{/novels/{id}/comment(id=${novel.id})}" method="post">
            <div class="mb-3">
                <textarea name="content" class="form-control" placeholder="Ajouter un commentaire..." required></textarea>
            </div>
            <button type="submit" class="btn btn-primary">Ajouter</button>
        </form>

        <!-- Bouton Retour -->
        <div class="text-center mt-4">
            <a th:href="@{/novels}" class="btn btn-custom px-4 py-2">← Retour à la liste</a>
        </div>
    </div>
</div>
</body>
</html>
